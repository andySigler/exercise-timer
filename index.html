<!DOCTYPE html>
<html>
    <head>
        <style type="text/css">
            body, p, h1, h2, select {
                font-family: Helvetica;
            }
            h1 {
                font-size: 300px;
                width:100%;
                margin-top:0px;
            }
            h2 {
                font-size: 40px;
                width:100%;
            }
            .container {
                width: 100%;
                max-width: 600px;
                margin-top:80px;
                margin-right: auto;
                margin-left: auto;
            }
        </style>
    </head>
    <body>
        <div class="container">
            <select id="exerciseSelect">
                <option value="backFocus">(Su/Th) Back Focus</option>
                <option value="stretch">(M/F) Stretch</option>
                <option value="fullBody">(Tu) Full Body</option>
                <option value="coreFocus">(W/Sa) Core Focus</option>
                <option value="simple">Simple</option>
            </select>
            <span id="description"></span>
            <br>
            <input type="checkbox" id="randomCheckbox"> Randomize
            <button onclick="start()">Start</button>
            <button onclick="pause()">Pause</button>
            <button onclick="stop()">Stop</button>
            <button onclick="skip()">Skip</button>
            <h2 id="exerciseName"></h2>
            <h1 id="exerciseSeconds"></h1>
        </div>
    </body>
    <script type="text/javascript">
        var warmUp = [
            {
                name: 'Deep Breathing',
                seconds: 30
            },
            {
                name: 'Move Shoulders Around',
                seconds: 30
            },
            {
                name: 'Foam Roller',
                seconds: 60
            },
            {
                name: 'Lax Ball',
                seconds: 60
            },
            {
                name: 'Stand Rotate Shoulders',
                seconds: 30
            },
            {
                name: 'Wall Arm Raises',
                seconds: 60
            },
            {
                name: 'Corner Stretch',
                seconds: 30
            },
            {
                name: 'Wall Lats Stretch',
                seconds: 30
            },
            {
                name: 'Chin Tucks',
                seconds: 30
            },
            {
                name: 'T-Spine Left',
                seconds: 3 * 60
            },
            {
                name: 'T-Spine Right',
                seconds: 3 * 60
            },
            {
                name: 'Cat Camel',
                seconds: 3 * 60
            },
            {
                name: 'Bird Dog',
                seconds: 3 * 60
            }
        ];
        var coolDown = [
            {
                name: 'Hamstring Right',
                seconds: 30
            },
            {
                name: 'Hamstring Left',
                seconds: 30
            },
            {
                name: 'Ball Foot Raises',
                seconds: 60 * 5
            },
            {
                name: 'Hamstring Right',
                seconds: 30
            },
            {
                name: 'Hamstring Left',
                seconds: 30
            },
        ];
        var exercises = {
            simple: {
                warmUp: true,
                coolDown: true,
                steps: []
            },
            stretch: {
                warmUp: false,
                coolDown: true,
                steps: [
                    {
                        name: 'Deep Breathing',
                        seconds: 30
                    },
                    {
                        name: 'Stand Bird Dog',
                        seconds: 60
                    },
                    {
                        name: 'Straight Leg Raises',
                        seconds: 60
                    },
                    {
                        name: 'Raised Knee Hip Right',
                        seconds: 30
                    },
                    {
                        name: 'Raised Knee Hip Left',
                        seconds: 30
                    },
                    {
                        name: 'Neck Forward Back',
                        seconds: 30
                    },
                    {
                        name: 'Neck Side Side',
                        seconds: 30
                    },
                    {
                        name: 'T-Spine Left',
                        seconds: 180
                    },
                    {
                        name: 'T-Spine Right',
                        seconds: 180
                    },
                    {
                        name: 'Downward Dog',
                        seconds: 30
                    },
                    {
                        name: 'Upward Dog',
                        seconds: 30
                    },
                    {
                        name: 'Lying Chest Right',
                        seconds: 30
                    },
                    {
                        name: 'Lying Chest Left',
                        seconds: 30
                    },
                    {
                        name: 'Childs Pose',
                        seconds: 30
                    },
                    {
                        name: 'Thread Needle Right',
                        seconds: 30
                    },
                    {
                        name: 'Thread Needle Left',
                        seconds: 30
                    },
                    {
                        name: 'Butchers Block',
                        seconds: 30
                    },
                    {
                        name: 'McKensie Push Ups',
                        seconds: 30
                    },
                    {
                        name: 'Hold Bird Dog Right',
                        seconds: 30
                    },
                    {
                        name: 'Hold Bird Dog Left',
                        seconds: 30
                    },
                    {
                        name: 'Lunge Hip Flex Right',
                        seconds: 30
                    },
                    {
                        name: 'Lunge Hip Flex Left',
                        seconds: 30
                    },
                    {
                        name: 'Elbow Lunge Left',
                        seconds: 30
                    },
                    {
                        name: 'Elbow Lunge Right',
                        seconds: 30
                    },
                    {
                        name: '90:90 Knee Right',
                        seconds: 30
                    },
                    {
                        name: '90:90 Foot Right',
                        seconds: 30
                    },
                    {
                        name: '90:90 Knee Left',
                        seconds: 30
                    },
                    {
                        name: '90:90 Foot Left',
                        seconds: 30
                    },
                    {
                        name: 'Reverse Plank',
                        seconds: 30
                    },
                    {
                        name: 'Full Squat',
                        seconds: 30
                    },
                    {
                        name: 'Calf Right',
                        seconds: 30
                    },
                    {
                        name: 'Calf Left',
                        seconds: 30
                    }
                ]
            },
            fullBody: {
                warmUp: true,
                coolDown: true,
                steps: [
                    {
                        name: 'Wall Sit',
                        seconds: 30
                    },
                    {
                        name: 'Elbow Rotate Right',
                        seconds: 90
                    },
                    {
                        name: 'Elbow Rotate Left',
                        seconds: 90
                    },
                    {
                        name: 'Push Ups',
                        seconds: 30
                    },
                    {
                        name: 'Stomach Back Arcs',
                        seconds: 45
                    },
                    {
                        name: 'Crunches',
                        seconds: 30
                    },
                    {
                        name: 'Chair Step Up',
                        seconds: 45
                    },
                    {
                        name: 'Squats',
                        seconds: 30
                    },
                    {
                        name: 'Tricep Dips',
                        seconds: 30
                    },
                    {
                        name: 'Walking Superman',
                        seconds: 30
                    },
                    {
                        name: 'Plank',
                        seconds: 60
                    },
                    {
                        name: 'Stomach "W" Arms',
                        seconds: 30
                    },
                    {
                        name: 'High Stepping',
                        seconds: 30
                    },
                    {
                        name: 'Lunges',
                        seconds: 30
                    },
                    {
                        name: 'Push-Ups & Rotation',
                        seconds: 30
                    },
                    {
                        name: 'Birdy Arm Raises',
                        seconds: 30
                    },
                    {
                        name: 'Side Plank Right',
                        seconds: 30
                    },
                    {
                        name: 'Side Plank Left',
                        seconds: 30
                    }
                ]
            },
            backFocus: {
                warmUp: true,
                coolDown: true,
                steps: [
                    {
                        name: 'Elbow Rotation Right',
                        seconds: 90
                    },
                    {
                        name: 'Elbow Rotation Left',
                        seconds: 90
                    },
                    {
                        name: 'Rope Pulls',
                        seconds: 60
                    },
                    {
                        name: 'Band Pull Down',
                        seconds: 60
                    },
                    {
                        name: 'Band Twist Pull Right',
                        seconds: 60
                    },
                    {
                        name: 'Band Twist Pull Left',
                        seconds: 60
                    },
                    {
                        name: 'Band Pull Up Right',
                        seconds: 60
                    },
                    {
                        name: 'Band Pull Up Left',
                        seconds: 60
                    },
                    {
                        name: '"I" Medicine Ball',
                        seconds: 60
                    },
                    {
                        name: '"T" Medicine Ball',
                        seconds: 30
                    },
                    {
                        name: '"Y" Medicine Ball',
                        seconds: 30
                    },
                    {
                        name: 'Walking Superman',
                        seconds: 30
                    }
                ]
            },
            coreFocus: {
                warmUp: true,
                coolDown: true,
                steps: [
                    {
                        name: 'Straight Leg Raises',
                        seconds: 60
                    },
                    {
                        name: 'Knee Hip Raise Right',
                        seconds: 30
                    },
                    {
                        name: 'Knee Hip Raise Left',
                        seconds: 30
                    },
                    {
                        name: 'Dead Bug',
                        seconds: 30
                    },
                    {
                        name: 'Plank',
                        seconds: 30
                    },
                    {
                        name: 'Side Plank Right',
                        seconds: 30
                    },
                    {
                        name: 'Side Plank Left',
                        seconds: 30
                    },
                    {
                        name: 'Hip Bridge',
                        seconds: 30
                    },
                    {
                        name: 'V Sit',
                        seconds: 30
                    },
                    {
                        name: 'Bicycle',
                        seconds: 30
                    },
                    {
                        name: 'Hanging Leg Raise',
                        seconds: 30
                    },
                    {
                        name: 'Ball Push Plank',
                        seconds: 30
                    }
                ]
            }
        };
        var schedule = [
            'backFocus',    // Sunday
            'stretch',      // Monday
            'fullBody',     // Tuesday
            'coreFocus',    // Wednesday
            'backFocus',    // Thursday
            'stretch',      // Friday
            'coreFocus',    // Saturday
        ];
        var restTime = 20;
        var fullExer = [];
        var interval = undefined;
        var currentSecond = 0;
        var currentStep = 0;
        var shuffle = function (array) {
            var currentIndex = array.length;
            var temporaryValue, randomIndex;
            while (0 !== currentIndex) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex -= 1;
                temporaryValue = array[currentIndex];
                array[currentIndex] = array[randomIndex];
                array[randomIndex] = temporaryValue;
            }
            return array;
        };
        function preloadExercise(autoDate) {
            var menu = document.getElementById('exerciseSelect');
            if (autoDate) {
                menu.value = schedule[new Date().getDay()];
            }
            fullExer = exercises[menu.value].steps.slice();
            var intro = [];
            if (exercises[menu.value].warmUp) {
                fullExer = warmUp.slice().concat(fullExer);
            }
            if (exercises[menu.value].coolDown) {
                fullExer = fullExer.concat(coolDown.slice());
            }
            var description = document.getElementById('description');
            description.innerHTML = String(fullExer.length) + ' Steps';
            var totMinutes = fullExer.reduce((tot, val) => {
                return tot + (val.seconds / 60);
            }, 0);
            totMinutes += (restTime * fullExer.length) / 60;
            description.innerHTML += ' (' + String(Math.round(totMinutes)) + ' Minutes)';
            displayNameTime();
        }
        function displayNameTime() {
            var exName = fullExer[currentStep].name;
            exName += '<br>' + String(currentStep + 1) + ' / ' + String(fullExer.length);
            document.getElementById('exerciseName').innerHTML = exName;
            var secondsDisplay = Math.floor(currentSecond);
            if (secondsDisplay >= 0) {
                secondsDisplay = fullExer[currentStep].seconds - secondsDisplay;
            }
            secondsDisplay = String(Math.abs(secondsDisplay));
            document.getElementById('exerciseSeconds').innerHTML = secondsDisplay;
        }
        function setColor(color) {
            document.body.style.backgroundColor = color;
        }
        function clearNameTime() {
            document.getElementById('exerciseName').innerHTML = 'Off';
            document.getElementById('exerciseSeconds').innerHTML = '...';
        }
        function workoutStep() {
            currentSecond += 1;
            if (currentSecond >= fullExer[currentStep].seconds) {
                currentSecond = restTime * -1;
                currentStep += 1;
                if (currentStep >= fullExer.length) {
                    stop();
                    return;
                }
            }
            if (currentSecond < 0) {
                displayNameTime();
                setColor('white');
            }
            else if (currentSecond < fullExer[currentStep].seconds){
                displayNameTime();
                setColor('rgb(0, 255, 123)');
            }
        }
        function pause() {
            if (interval !== undefined) {
                clearInterval(interval);
                interval = undefined;
                setColor('white');
            }
        }
        function start() {
            if (document.getElementById('randomCheckbox').checked) {
                var selection = document.getElementById('exerciseSelect');
                if (exercises[selection.value].warmUp) {
                    fullExer = fullExer.slice(warmUp.length);
                }
                if (exercises[selection.value].coolDown) {
                    fullExer = fullExer.slice(
                        0, fullExer.length - coolDown.length);
                }
                fullExer = shuffle(fullExer);                  // shuffle
                if (exercises[selection.value].warmUp) {
                    fullExer = warmUp.slice().concat(fullExer);  // add warmup
                }
                if (exercises[selection.value].warmUp) {
                    fullExer = fullExer.concat(coolDown);  // add cooldown
                }
            }
            if (!interval) {
                interval = setInterval(workoutStep, 1000);
                workoutStep();
            }
        }
        function stop() {
            pause();
            clearNameTime();
            currentStep = 0;
            currentSecond = restTime * -1;
            setColor('grey');
        }
        function skip() {
            var oldStep = Math.floor(currentStep);
            var maxLen = Math.floor(fullExer.length);
            stop();
            currentStep = (oldStep + 1) % maxLen;
            start();

        }
        window.addEventListener('load', (event) => {
            document.getElementById('exerciseSelect').addEventListener('change', (e) => {
                preloadExercise();
            });
            stop();
            preloadExercise(true);
        });
    </script>
</html>
